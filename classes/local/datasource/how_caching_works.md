# Caching in CMS datasources.

In the CMS plugin, the generated content is cached on two levels.

Each datasource is responsible for caching its own data for each instance. The overall content generated by the CMS instance is also cached.

Each datasource supplies two key fragments. the config key and the instance key.

The config key represents the configuration. It should change whenever the configuration changes, and be unique for the configuration, but is otherwise the same for all instances. The hash for this key is stored in the cms_types.customdata field

The instance key represents the instance. It should change whenever the instance data changes, and be unique for each instance. The hash/rev is stored cms.customdata.

Most of the time a hash of the data is used for the key. In some cases, this is unpractical, and so a revision number is used instead.

The data for each datasource for each instance is cached under a key made up of a combination of the config and instance cache key.

The overall content is also cached, using a key derived from the combination of all the datasource keys.

This approach allows for one datasource to change without having to recalculate all the data from all the other datasources.

Sometimes a datsource cannot be cached. It's data needs to be recalculated each time. Therefore the overall rendered content for the CMS instance cannot be cached either. In this case the function get_full_cache_key() should return null. This acts as a kind of veto that prevents the CMS from caching the rendered content.
